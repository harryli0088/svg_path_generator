<html>
<svg width="500" height="500" style="background: gray"></svg>

<script src="https://d3js.org/d3.v5.min.js"></script>
<script type="text/javascript">
  const path_data = {
    start: {
      x: 0,
      y: 0,
    },
    sections: [
      {dx: 100, dy: 200, r: 0},
      {dx: 100, dy: 100, r: 100}
    ],
    step_size: 20,
    wiggle_size: 5
  };

  function generate_section(section, current_pos, step_size, wiggle_size) {
    let d = ""; //the path data string to eventually return

    let distance;
    let num_steps;
    let step_unit_vector = {x: 0, y: 0}; //the unit vector pointing in the direction of the next step
    let wiggle_vector = {x: 0, y: 0};

    //if there is a radius
    if(section.r !== 0) {

    }
    //else this is a straight line
    else {
      d = "C"; //string to return later

      distance = Math.sqrt(Math.pow(section.dx,2) + Math.pow(section.dy,2)); //find the distance
      num_steps = Math.max( Math.round(distance/step_size) , 1 ); //force there to be at least one step
      step_unit_vector = {x: section.dx/distance, y: section.dy/distance}; //create a unit vector of the direction we're going in

      //get each point along this line with a wiggle
      for(let i=1; i<=num_steps; ++i) {
        const dx_i = i/num_steps*section.dx; //get the x distance of this step from the origin
        const dy_i = i/num_steps*section.dy; //get the y distance of this step from the origin

        current_pos.x += dx_i - current_pos.x; //add the x difference
        current_pos.y += dy_i - current_pos.y; //add the y difference

        const wiggle = wiggle_size*(2*Math.random() - 1); //generate a random number in the range [-wiggle_size, wiggle_size]

        wiggle_vector = {x: wiggle*step_unit_vector.y, y:-1*wiggle*step_unit_vector.x}; //calculate the wiggle vector

        d += (current_pos.x + wiggle_vector.x).toFixed(2) + " " + (current_pos.y + wiggle_vector.y).toFixed(2) + " "; //add the next point with some wiggle
      }
    }

    return d;
  }


  function generate_path(path_data) {
    let current_pos = {x: path_data.start.x, y: path_data.start.y};
    let d = "M"+path_data.start.x+" "+path_data.start.y+" ";
    for(let i=0; i<path_data.sections.length; ++i) {
      d += generate_section(path_data.sections[i], current_pos, path_data.step_size, path_data.wiggle_size);
    }
    return d + "Z";
  }


  d3.select("svg").append("path").attr("fill","pink")
  .attr("d",generate_path(path_data));








function get_arc_length(dx,dy,r) {
  const direct_distance = Math.sqrt( Math.pow(dx,2) + Math.pow(dy,2) ); //get direct distance between the two points of the arc
  const angle = Math.sin( direct_distance/(2*r) ); //get the angle of the arc
  return angle * r; //return the distance
}

  const num_steps = Math.max( 1, Math.round(distance/step_size) );


  const direction =

  let prev = {x:0,y:0};

  for(let i=1; i<=num_steps; ++i) {

      //get the step vector here

      //get the wiggle and wiggle vector here

      const angle_i = (i/num_steps) * angle; //get the next step angle
      const from_origin = {
          x: section.r - Math.cos(angle_i)*section.r,
          y: Math.sin(angle_i)*section.r
      };
  }
}



</script>

</html>
